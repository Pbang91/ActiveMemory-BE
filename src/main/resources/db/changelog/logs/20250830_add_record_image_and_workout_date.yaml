databaseChangeLog:
  - changeSet:
      id: add-record-image-table
      author: ggpark
      preConditions:
        - onFail: MARK_RAN
          not:
            tableExists:
              tableName: record_image
      changes:
        - createTable:
            tableName: record_image
            columns:
              - column:
                  name: id
                  type: bigint
                  constraints:
                    primaryKey: true
                    nullable: false
              - column:
                  name: object_key
                  type: varchar(100)
                  constraints:
                    nullable: false
              - column:
                  name: display_order
                  type: smallint
                  constraints:
                    nullable: false
              - column:
                  name: record_id
                  type: bigint
                  constraints:
                    nullable: false
              - column:
                  name: created_at
                  type: "timestamp without time zone"
                  defaultValueComputed: CURRENT_TIMESTAMP
                  constraints:
                    nullable: false
        - addForeignKeyConstraint:
            baseTableName: record_image
            baseColumnNames: record_id
            referencedTableName: record
            referencedColumnNames: id
            constraintName: fk_record_image_record
            onDelete: NO ACTION
        - createIndex:
            tableName: record_image
            indexName: idx_record_image_record_id
            columns:
              - column:
                  name: record_id
  - changeSet:
      id: add-workout-date-column
      author: ggpark
      preConditions:
        - onFail: MARK_RAN
          not:
            columnExists:
              tableName: record
              columnName: workout_date
      changes:
        - addColumn:
            tableName: record
            columns:
              - column:
                  name: workout_date
                  type: date
                  constraints:
                    nullable: false